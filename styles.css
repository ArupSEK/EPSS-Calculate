:root{
  --text:#0b1020;
  --muted:#3a4666;
  --bg1: rgba(255,47,214,.55);
  --bg2: rgba(34,211,255,.55);
  --bg3: rgba(45,255,179,.45);
  --bg4: rgba(255,180,45,.45);
  --bg5a: rgba(255,240,74,.35);
  --bg5b: rgba(138,91,255,.15);
  --bg5c: rgba(255,47,214,.20);
  --cardA: rgba(255,255,255,.72);
  --cardB: rgba(255,255,255,.42);
  --border: rgba(255,255,255,.75);
  --softBg: rgba(255,255,255,.50);
  --shadow: 0 22px 60px rgba(0,0,0,.18);

  --pink:#ff2fd6;
  --purple:#8a5bff;
  --blue:#22d3ff;
  --mint:#2dffb3;
  --orange:#ffb42d;
  --yellow:#fff04a;
  --red:#ff3b3b;
}

[data-theme="dark"]{
  --text:#e9eefc;
  --muted:#b2bed8;
  --bg1: rgba(30,12,48,.8);
  --bg2: rgba(10,30,50,.8);
  --bg3: rgba(8,40,32,.75);
  --bg4: rgba(50,30,10,.75);
  --bg5a: rgba(20,20,30,.9);
  --bg5b: rgba(35,20,55,.7);
  --bg5c: rgba(25,10,35,.6);
  --cardA: rgba(14,18,34,.82);
  --cardB: rgba(14,18,34,.62);
  --border: rgba(255,255,255,.12);
  --softBg: rgba(20,24,42,.75);
  --shadow: 0 22px 60px rgba(0,0,0,.55);
}

*{box-sizing:border-box}
html,body{height:100%}

body{
  margin:0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
  color:var(--text);
  overflow-x:hidden;

  background:
    radial-gradient(1200px 900px at 10% -10%, var(--bg1), transparent 55%),
    radial-gradient(1000px 800px at 90% -10%, var(--bg2), transparent 55%),
    radial-gradient(1100px 900px at 40% 115%, var(--bg3), transparent 60%),
    radial-gradient(900px 700px at 95% 70%, var(--bg4), transparent 60%),
    linear-gradient(135deg, var(--bg5a), var(--bg5b), var(--bg5c));
}

/* Floating blobs */
body::before{
  content:"";
  position:fixed;
  inset:-60px;
  background:
    radial-gradient(320px 260px at 15% 25%, var(--bg1), transparent 60%),
    radial-gradient(340px 280px at 75% 30%, var(--bg2), transparent 62%),
    radial-gradient(360px 300px at 30% 85%, var(--bg3), transparent 64%),
    radial-gradient(380px 320px at 85% 85%, var(--bg4), transparent 66%);
  filter: blur(18px);
  z-index:-1;
  animation: blobs 10s ease-in-out infinite alternate;
}
@keyframes blobs{
  from{ transform: translate3d(-12px,-10px,0) scale(1.00); }
  to  { transform: translate3d(14px,12px,0) scale(1.06); }
}

.container{max-width:1150px;margin:0 auto;padding:18px}

/* Topbar */
.topbar{
  position:sticky;top:0;z-index:50;
  backdrop-filter: blur(14px);
  background: color-mix(in srgb, var(--cardA) 70%, transparent);
  border-bottom: 1px solid var(--border);
}
.topbar__inner{display:flex;align-items:center;justify-content:space-between;gap:12px}

/* Brand */
.brand{display:flex;align-items:center;gap:12px}
.brand__logo{
  width:46px;height:46px;border-radius:16px;
  display:grid;place-items:center;
  font-weight:1000;
  color:white;
  background: linear-gradient(135deg, var(--pink), var(--purple), var(--blue), var(--mint));
  box-shadow: 0 16px 40px rgba(255,47,214,.25);
}
.brand__name{font-weight:1000}
.brand__sub{font-size:12px;color:rgba(20,30,60,.7)}

/* Cards */
.card{
  background: linear-gradient(180deg, var(--cardA), var(--cardB));
  border: 1px solid var(--border);
  border-radius: 26px;
  box-shadow: var(--shadow);
  padding: 18px;
  margin: 16px 0;
  backdrop-filter: blur(14px);
  position:relative;
  overflow:hidden;
}
.tabPanel--sticky{overflow:visible;}
.card--soft{
  background: var(--softBg);
  box-shadow:none;
}

/* Rainbow border */
.card::after{
  content:"";
  position:absolute;inset:0;
  border-radius:26px;
  padding:2px;
  background: linear-gradient(135deg,
    rgba(255,47,214,.95),
    rgba(138,91,255,.85),
    rgba(34,211,255,.85),
    rgba(45,255,179,.75),
    rgba(255,240,74,.70),
    rgba(255,180,45,.75)
  );
  -webkit-mask:
     linear-gradient(#000 0 0) content-box,
     linear-gradient(#000 0 0);
  -webkit-mask-composite: xor;
          mask-composite: exclude;
  pointer-events:none;
  opacity:.55;
}

/* Typography */
h1{margin:0 0 8px;font-size:32px;line-height:1.12}
h2{margin:0 0 10px;font-size:22px}
h3{margin:0 0 10px;font-size:18px}
.muted{color:rgba(20,30,60,.65)}
.tiny{font-size:12px;color:rgba(20,30,60,.6)}

/* Hero */
.hero{display:grid;grid-template-columns: 1.2fr .8fr; gap:14px}
@media (max-width:920px){.hero{grid-template-columns:1fr}}

.hero__stats{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px}
.pill{
  padding:8px 12px;
  border-radius:999px;
  font-size:12px;
  font-weight:800;
  color: rgba(10,16,32,.85);
  background: linear-gradient(135deg, rgba(255,47,214,.25), rgba(34,211,255,.20), rgba(45,255,179,.18));
  border: 1px solid rgba(255,255,255,.75);
}

/* Tabs */
.tabs{display:flex;gap:10px;margin-top:14px;flex-wrap:wrap}
.tab{
  border:1px solid rgba(255,255,255,.75);
  background: rgba(255,255,255,.55);
  color: rgba(8,16,32,.88);
  padding:10px 14px;
  border-radius:16px;
  cursor:pointer;
  font-weight:900;
  transition: transform .12s ease, filter .12s ease;
}
.tab:hover{ transform: translateY(-2px) rotate(-.2deg); filter: brightness(1.03); }
.tab--active{
  background: linear-gradient(135deg, rgba(255,47,214,.40), rgba(138,91,255,.22), rgba(34,211,255,.22), rgba(45,255,179,.22));
  box-shadow: 0 14px 40px rgba(138,91,255,.14);
}
.tabPanel.hidden{display:none}

.grid2{display:grid;grid-template-columns:1fr 1fr;gap:14px}
.grid2--stack{grid-template-columns:1fr;}
.grid2 > div{min-width:0;}

/* Small chart box */
.chartCard{
  max-width:360px;
  margin: 6px 0 12px auto;
  text-align:right;
}
.chartCard--small h3{font-size:15px;margin-bottom:6px;}

.chartStats{
  margin-top:8px;
  display:grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap:6px;
  text-align:left;
}
.statChip{
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:6px 8px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,.75);
  background: rgba(255,255,255,.55);
  font-size:11px;
  font-weight:900;
}
.statChip span{color:rgba(8,16,32,.65)}
.statChip b{font-size:12px}

.chartTop{
  margin-top:8px;
  text-align:left;
}
.topList{
  margin-top:4px;
  padding:6px 8px;
  border-radius:10px;
  border:1px solid rgba(255,255,255,.75);
  background: rgba(255,255,255,.55);
  font-size:11px;
  line-height:1.4;
  max-height:88px;
  overflow:auto;
}
@media (max-width:920px){.grid2{grid-template-columns:1fr}}

/* Inputs */
.label{display:block;font-size:12px;color:rgba(20,30,60,.65);margin:10px 0 6px;font-weight:900}
.input{
  width:100%;
  padding:12px 12px;
  border-radius:16px;
  border:1px solid var(--border);
  background: color-mix(in srgb, var(--cardA) 80%, transparent);
  color: rgba(8,16,32,.9);
  outline:none;
  transition: box-shadow .15s ease, transform .12s ease;
}
.input:focus{
  box-shadow:
    0 0 0 5px rgba(34,211,255,.18),
    0 0 0 9px rgba(255,47,214,.10);
  transform: translateY(-1px);
}
textarea.input{resize:vertical}

.row{display:flex;gap:10px;align-items:center;margin-top:10px;flex-wrap:wrap}
.excelActions{
  position:static;
  padding:0;
  border-radius:0;
  background: transparent;
  border:none;
  box-shadow:none;
  backdrop-filter:none;
}
.status{margin-top:10px;font-size:12px;color:rgba(20,30,60,.7);font-weight:900}
.previewControls{
  display:grid;
  grid-template-columns: minmax(180px, 240px) 1fr;
  gap:14px;
  margin-top:10px;
}
@media (max-width:720px){
  .previewControls{grid-template-columns:1fr}
}
.choiceGroup{display:flex;gap:10px;flex-wrap:wrap}
.choiceChip{
  display:flex;
  align-items:center;
  gap:8px;
  padding:8px 12px;
  border-radius:999px;
  border:1px solid var(--border);
  background: linear-gradient(135deg, color-mix(in srgb, var(--pink) 22%, transparent), color-mix(in srgb, var(--blue) 18%, transparent), color-mix(in srgb, var(--mint) 18%, transparent));
  font-size:12px;
  font-weight:1000;
}
.choiceChip input{ accent-color: var(--purple); transform: scale(1.05); }

/* Sub sections for clarity */
.subCard{
  margin-top:12px;
  padding:12px;
  border-radius:18px;
  border:1px solid var(--border);
  background: color-mix(in srgb, var(--cardA) 70%, transparent);
}

/* Buttons (Candy) */
.btn{
  border:none;
  cursor:pointer;
  padding:12px 16px;
  border-radius:16px;
  font-weight:1000;
  color: white;
  letter-spacing:.2px;
  background: linear-gradient(135deg, var(--pink), var(--purple), var(--blue), var(--mint));
  box-shadow:
    0 18px 45px rgba(255,47,214,.20),
    0 14px 40px rgba(34,211,255,.14);
  transition: transform .12s ease, filter .15s ease;
  position:relative;
  display:inline-flex;
  align-items:center;
  gap:10px;
}
.btn:hover{ transform: translateY(-2px) scale(1.01); filter: saturate(1.1) brightness(1.05); }
.btn:active{ transform: translateY(1px) scale(.99); }
.btn:disabled{ opacity:.65; cursor:not-allowed; transform:none; }

.btn--ghost{
  background: color-mix(in srgb, var(--cardA) 75%, transparent);
  color: rgba(8,16,32,.9);
  border:1px solid var(--border);
  box-shadow: 0 12px 30px rgba(0,0,0,.10);
}
.btn--small{padding:8px 10px;border-radius:14px;font-size:12px}

/* Spinner inside button */
.btnSpinner{
  width:14px;height:14px;
  border-radius:50%;
  border:2px solid rgba(255,255,255,.55);
  border-top-color: rgba(255,255,255,1);
  display:none;
  animation: spin .8s linear infinite;
}
@keyframes spin{ to{ transform: rotate(360deg); } }
.btn.isLoading .btnSpinner{ display:inline-block; }
.btn.isLoading .btnText{ opacity:.95; }

/* Checkbox chips */
.chip{
  display:flex;
  align-items:center;
  gap:8px;
  padding:8px 12px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.85);
  background: linear-gradient(135deg, rgba(255,47,214,.16), rgba(34,211,255,.14), rgba(45,255,179,.14));
  font-size:12px;
  font-weight:1000;
}
.chip input{ accent-color: var(--pink); transform: scale(1.05); }

/* Summary chips */
.summaryRow{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  margin-top:10px;
}
.summaryChip{
  padding:8px 12px;
  border-radius:999px;
  font-size:12px;
  font-weight:1000;
  border:1px solid rgba(255,255,255,.85);
  background: linear-gradient(135deg, rgba(255,47,214,.16), rgba(34,211,255,.12), rgba(45,255,179,.10));
}

/* Result box */
.resultBox{
  border:1px solid rgba(255,255,255,.80);
  border-radius:18px;
  background: rgba(255,255,255,.45);
  overflow:hidden;
}
.resultBox__header{
  padding:12px 12px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  border-bottom:1px solid rgba(255,255,255,.75);
}

/* Table */
.tableWrap{
  overflow:auto;
  border-radius: 16px;
  border:1px solid var(--border);
  background: color-mix(in srgb, var(--cardA) 60%, transparent);
}
.tableWrap--results{max-height: 320px;}
.tableWrap--preview{max-height: min(60vh, 520px);}
.tableWrap--preview{
  overflow-x:scroll;
  overflow-y:auto;
  scrollbar-gutter: stable both-edges;
  width:100%;
  max-width:100%;
  display:block;
}
.tableWrap--preview .table{width:max-content; min-width:100%; table-layout:auto;}

.table{
  width:100%;
  border-collapse:separate;
  border-spacing:0;
  font-size:13px;
}
.table th,.table td{
  padding:10px 10px;
  border-bottom:1px solid rgba(255,255,255,.70);
  vertical-align:top;
  white-space:nowrap;
}
.table th{
  position:sticky;top:0;
  background: linear-gradient(135deg, color-mix(in srgb, var(--pink) 22%, transparent), color-mix(in srgb, var(--blue) 18%, transparent), color-mix(in srgb, var(--mint) 18%, transparent));
  text-align:left;
  font-weight:1000;
  color: rgba(8,16,32,.92);
  cursor:pointer;
  user-select:none;
}
.table th .sortHint{ opacity:.6; font-weight:900; margin-left:6px; }
.table--preview th{cursor:default; white-space:nowrap; max-width:220px;}
.table--preview th,.table--preview td{min-width:140px;}
.table--preview td{max-width:260px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;}

/* Scroll hint */
.scrollHint{
  margin-top:6px;
  padding:6px 10px;
  border-radius:999px;
  border:1px dashed rgba(255,255,255,.75);
  background: rgba(255,255,255,.45);
  color: rgba(8,16,32,.7);
  font-size:11px;
  font-weight:900;
  display:inline-flex;
  align-items:center;
  gap:8px;
}
.scrollControl{
  margin-top:6px;
  width:100%;
}
.scrollRange{
  width:100%;
  accent-color: var(--purple);
}
.table--preview th[draggable="true"]{cursor:grab}
.table--preview td.isSelected,
.table--preview th.isSelected{
  background: linear-gradient(90deg, rgba(138,91,255,.22), rgba(34,211,255,.14));
}
.table tbody tr:hover td{
  background: linear-gradient(90deg,
    rgba(255,47,214,.14),
    rgba(138,91,255,.12),
    rgba(34,211,255,.12),
    rgba(45,255,179,.12),
    rgba(255,240,74,.10),
    rgba(255,180,45,.10)
  );
}
.table td:first-child{font-weight:1000}

/* EPSS badge */
.badge{
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:6px 10px;
  border-radius:999px;
  font-weight:1000;
  border:1px solid rgba(255,255,255,.85);
}
.badge--green{ background: rgba(45,255,179,.22); }
.badge--yellow{ background: rgba(255,240,74,.22); }
.badge--orange{ background: rgba(255,180,45,.22); }
.badge--red{ background: rgba(255,59,59,.22); }

/* Progress */
.progress{
  height:10px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,.85);
  overflow:hidden;
  margin-top:10px;
  background: rgba(255,255,255,.50);
}
.progress__bar{
  height:100%;
  background: linear-gradient(90deg, var(--pink), var(--purple), var(--blue), var(--mint), var(--yellow), var(--orange));
}

/* Slider */
.slider{min-height:180px;position:relative;overflow:hidden}
.slider__slide{display:none}
.slider__slide--active{display:block}
.slideTitle{font-weight:1000;margin-bottom:6px}
.slideBody{color:rgba(20,30,60,.68);font-weight:900}
.slider__dots{display:flex;gap:6px;position:absolute;bottom:12px;left:12px}
.dot{width:9px;height:9px;border-radius:50%;background: rgba(10,16,32,.20)}
.dot--active{background: linear-gradient(135deg, var(--pink), var(--blue), var(--mint))}

/* Toast */
.toast{
  position:fixed;
  right:16px;
  bottom:16px;
  background: color-mix(in srgb, var(--cardA) 80%, transparent);
  border:1px solid var(--border);
  border-radius:18px;
  padding:12px 14px;
  box-shadow: var(--shadow);
  max-width:340px;
  backdrop-filter: blur(14px);
  font-weight:1000;
}
.toast.hidden{display:none}

/* Footer */
.footer{padding:18px 2px;font-size:12px;color:rgba(20,30,60,.65);font-weight:900}

/* Header actions + Developed badge */
.topbar__actions{ display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
.themeToggle{
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:8px 12px;
  border-radius:999px;
  border:1px solid var(--border);
  background: color-mix(in srgb, var(--cardA) 75%, transparent);
  font-size:12px;
  font-weight:900;
  cursor:pointer;
}
.themeToggle input{ accent-color: var(--purple); }
.themeToggle__label{ color: var(--text); }

.devBadge{
  display:flex;
  align-items:center;
  gap:10px;
  padding:10px 14px;
  border-radius:999px;
  border:2px solid rgba(255,255,255,.90);
  background: linear-gradient(135deg,
    rgba(255,47,214,.32),
    rgba(138,91,255,.22),
    rgba(34,211,255,.22),
    rgba(45,255,179,.18),
    rgba(255,240,74,.18)
  );
  box-shadow: 0 14px 36px rgba(0,0,0,.12);
  position:relative;
  overflow:hidden;
}
.devBadge::before{
  content:"";
  position:absolute;
  top:-40px;
  left:-60px;
  width:140px;
  height:160px;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,.75), transparent);
  transform: rotate(25deg);
  animation: shine 2.6s linear infinite;
}
@keyframes shine{
  0%{ transform: translateX(-140px) rotate(25deg); opacity:0; }
  18%{ opacity:.7; }
  55%{ opacity:.95; }
  100%{ transform: translateX(520px) rotate(25deg); opacity:0; }
}
.devBadge__dot{
  width:12px;height:12px;border-radius:50%;
  background: linear-gradient(135deg, var(--pink), var(--blue), var(--mint));
  box-shadow: 0 0 0 0 rgba(255,47,214,.45);
  animation: pulse 1.3s ease-in-out infinite;
}
@keyframes pulse{
  0%{ box-shadow: 0 0 0 0 rgba(255,47,214,.45); transform: scale(1); }
  70%{ box-shadow: 0 0 0 16px rgba(255,47,214,0); transform: scale(1.06); }
  100%{ box-shadow: 0 0 0 0 rgba(255,47,214,0); transform: scale(1); }
}
.devBadge__text{ font-weight:1000; color: rgba(8,16,32,.92); font-size:13px; }
